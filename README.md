# document-management-system
A Document management system written using Nodejs and Mongodb  

Prerequisite: docker and docker-compose.  

Steps to run the application:  
1) docker build -t dms .  
2) docker pull mongo  
3) docker-compose up -d  

It will start the server on 8080 and will connect to tenantregistry-dev[Mongo Db].  

Upon the start dummy data will be seeded based on the seed flag present in config files.  

If seed is set to true dummy data will be inserted to accounts collection and users collection in mongo.  

Accounts collection maintain the account info like mongo tenant to connect to and users collection contains info like email, pasword and accountId to which user belongs to.  

Dummy accounts data: [  
      &nbsp;&nbsp;&nbsp;&nbsp;{  
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"accountId" : "DMS_u001",  
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"accountName" : "Automate.io",  
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"uri" : {  
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"dms" : `mongodb://mongo:27017/automate-io`  
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},  
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"active" : true  
      &nbsp;&nbsp;&nbsp;&nbsp;},  
      &nbsp;&nbsp;&nbsp;&nbsp;{  
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"accountId" : "DMS_u002",  
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"accountName" : "test",  
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"uri" : {  
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"dms" : "mongodb://mongo:27017/test"  
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},  
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"active" : true  
      &nbsp;&nbsp;&nbsp;&nbsp;}  
    &nbsp;&nbsp;&nbsp;&nbsp;]  
  
Dummy users data:  
&nbsp;&nbsp;&nbsp;&nbsp;[  
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{  
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;provider: 'local',  
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name: 'Test User',  
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;email: 'test@example.com',  
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;password: 'test',  
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accountId: 'DMS_u001',  
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;active: true,  
      &nbsp;&nbsp;&nbsp;&nbsp;}, {  
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;provider: 'local',  
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name: 'Test User',  
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;email: 'test2@example.com',  
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;password: 'test2',  
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accountId: 'DMS_u002',  
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;active: true,  
      &nbsp;&nbsp;&nbsp;&nbsp;},  
      &nbsp;&nbsp;&nbsp;&nbsp;{  
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;provider: 'local',  
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name: 'Admin',  
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;email: 'admin@example.com',  
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;password: 'admin',  
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accountId: 'DMS_u001',  
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;active: true,  
&nbsp;&nbsp;&nbsp;&nbsp;}]  

In mongo passwords are converted to its corresponding salt and hash.  

Since I am not able to run mongo as replica set in docker, move api wont work, as it uses transactions[WIP].  

I have kept only one schema for file and folders.  

Mongo DB Schema:  


directory: {  
	&nbsp;&nbsp;&nbsp;&nbsp;"_id" : "auto generated mongo object id",  
	&nbsp;&nbsp;&nbsp;&nbsp;"parent" : "/ttt" "the directory where the file/folder is going to be created",  
	&nbsp;&nbsp;&nbsp;&nbsp;"path" : "/ttt/abc.js""Actual path of the file or folder",  
	&nbsp;&nbsp;&nbsp;&nbsp;"content" : "<If file, the content of the file",  
	&nbsp;&nbsp;&nbsp;&nbsp;"type" : "whether it is file or folder",  
	&nbsp;&nbsp;&nbsp;&nbsp;"createdBy" : "_id of the user who created this entry",  
	&nbsp;&nbsp;&nbsp;&nbsp;"createdAt" : "time when the entry was created",  
	&nbsp;&nbsp;&nbsp;&nbsp;"updatedAt" : "time when the entry was updated",  
}  

Directory schema will be part of the tenant for which user is part of.  

accounts:{  
	&nbsp;&nbsp;&nbsp;&nbsp;"_id" : "auto generated mongo object id",  
	&nbsp;&nbsp;&nbsp;&nbsp;"accountId" : "account id any id, can be autogenerated",  
	&nbsp;&nbsp;&nbsp;&nbsp;"accountName" : "Name of the account",  
	&nbsp;&nbsp;&nbsp;&nbsp;"uri" : {  
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"dms" : "Mongo DB Uri for the account"  
	&nbsp;&nbsp;&nbsp;&nbsp;},
	&nbsp;&nbsp;&nbsp;&nbsp;"active" : true
}  
      
Accounts schema is part of tenantregistry where every accounts info will be kept.  


users: {  
	&nbsp;&nbsp;&nbsp;&nbsp;"_id" : "Autogenerated mongo id",    
	&nbsp;&nbsp;&nbsp;&nbsp;"forgotPassSecureHash" : "",  
	&nbsp;&nbsp;&nbsp;&nbsp;"passwordChange" : false,  
	&nbsp;&nbsp;&nbsp;&nbsp;"active" : true,  
	&nbsp;&nbsp;&nbsp;&nbsp;"provider" : "local",  
	&nbsp;&nbsp;&nbsp;&nbsp;"name" : "Test User",  
	&nbsp;&nbsp;&nbsp;&nbsp;"email" : "test@example.com",  
	&nbsp;&nbsp;&nbsp;&nbsp;"password" : "",  
	&nbsp;&nbsp;&nbsp;&nbsp;"accountId" : "DMS_u001",  
	&nbsp;&nbsp;&nbsp;&nbsp;"salt" : "",  
}  

Users schema is part of tenantregistry where all the users from every accounts are kept.


